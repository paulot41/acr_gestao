acrsantatecla.duckdns.org proformsc.duckdns.org {
  # Configurações de segurança
  header {
    # Remover headers que revelam informação do servidor
    -Server
    -X-Powered-By

    # Headers de segurança
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    X-XSS-Protection "1; mode=block"
    Referrer-Policy "strict-origin-when-cross-origin"
    Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self';"
  }

  # Compressão
  encode gzip zstd

  # Servir arquivos estáticos diretamente
  handle_path /static/* {
    root * /app/staticfiles
    file_server
    header Cache-Control "public, max-age=31536000"
  }

  handle_path /media/* {
    root * /app/media
    file_server
    header Cache-Control "public, max-age=86400"
  }

  # Proxy para Django
  reverse_proxy web:8000 {
    header_up X-Forwarded-Proto {scheme}
    header_up X-Forwarded-For {remote_host}
    header_up X-Real-IP {remote_host}

    # Timeouts
    transport http {
      dial_timeout 10s
      response_header_timeout 30s
    }
  }

  # Logs
  log {
    output file /var/log/caddy/access.log
    format json
  }
}
