{% extends 'core/base.html' %}
{% load static %}

{% block title %}Horários - ACR Gestão{% endblock %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb" class="container mt-3">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{% url 'core:dashboard_router' %}">Dashboard</a></li>
    <li class="breadcrumb-item active">Horários</li>
  </ol>
</nav>
{% endblock %}

{% block content %}
<div class="row mb-4">
  <div class="col-md-8">
    <h1><i class="bi bi-calendar3 me-2"></i>Horários</h1>
    <p class="text-muted">Agenda diária de aulas e eventos</p>
  </div>
  <div class="col-md-4">
    <form method="get" class="d-flex gap-2 justify-content-end align-items-end">
      <div>
        <label for="date" class="form-label mb-1">Data</label>
        <input type="date" id="date" name="date" value="{{ selected_date|date:'Y-m-d' }}" class="form-control">
      </div>
      <div>
        <button class="btn btn-primary mt-4" type="submit">
          <i class="bi bi-search me-1"></i>Filtrar
        </button>
      </div>
      <div>
        <a href="{% url 'core:event_add' %}" class="btn btn-success mt-4">
          <i class="bi bi-plus-circle me-1"></i>Novo Evento
        </a>
      </div>
    </form>
  </div>
</div>

<div class="card modern-card">
  <div class="card-body">
    {% if events %}
      <div class="table-responsive">
        <table class="table table-hover">
          <thead class="table-light">
            <tr>
              <th>Hora</th>
              <th>Título</th>
              <th>Espaço</th>
              <th>Instrutor</th>
              <th>Modalidade</th>
              <th>Capacidade</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            {% for event in events %}
              <tr>
                <td>
                  <strong>{{ event.starts_at|date:"H:i" }}</strong> - {{ event.ends_at|date:"H:i" }}
                </td>
                <td>{{ event.title }}</td>
                <td><span class="badge bg-secondary">{{ event.resource.name }}</span></td>
                <td>{% if event.instructor %}{{ event.instructor.full_name }}{% else %}<span class="text-muted">-</span>{% endif %}</td>
                <td>{% if event.modality %}<span class="badge" style="background-color: {{ event.modality.color }};">{{ event.modality.name }}</span>{% else %}<span class="text-muted">-</span>{% endif %}</td>
                <td>{{ event.capacity }}</td>
                <td>
                  <div class="btn-group btn-group-sm">
                    <a href="{% url 'core:event_edit' event.pk %}" class="btn btn-outline-primary" title="Editar">
                      <i class="bi bi-pencil"></i>
                    </a>
                    <a href="{% url 'core:event_delete' event.pk %}" class="btn btn-outline-danger" title="Eliminar">
                      <i class="bi bi-trash"></i>
                    </a>
                  </div>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-center py-5">
        <i class="bi bi-calendar-x text-muted" style="font-size: 3rem;"></i>
        <h5 class="mt-3">Sem eventos para esta data</h5>
        <p class="text-muted">Experimente outra data ou crie um novo evento.</p>
        <a href="{% url 'core:event_add' %}" class="btn btn-success">
          <i class="bi bi-plus-circle me-1"></i>Novo Evento
        </a>
        <a href="{% url 'core:gantt' %}" class="btn btn-outline-primary ms-2">
          <i class="bi bi-calendar-week me-1"></i>Abrir Gantt
        </a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
